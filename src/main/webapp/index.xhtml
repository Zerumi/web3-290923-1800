<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <meta name="viewport" content="initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html" />
        <h:outputStylesheet library="css" name="style.css" />
        <title>web3-290923-1800</title>
    </h:head>
    <h:body>
        <!--- legacy-чертовщина) -->
        <div id="container" class="margin">
            <div id="header" class="blured-container round-container margin">
                <p>web3-290923-1800</p>
                <p>by Afanasyev Kirill Aleksandrovich, group no. P3206</p>
                <p>Variant no. 1800</p>
            </div>
            <div id="main" class="margin">
                <div id="choose" class="blured-container round-container margin">
                    <p>Enter parameters:</p>
                    <p><i>Notice!</i> <b>Every</b> parameter <b>should be filled!</b></p>
                    <h:form>
                        <div id="x-select-container" class="select-container margin">
                            <h:outputLabel for="x-select-m2">Choose X:</h:outputLabel>
                            <div class="select-input-container">
                                <div id="x-select-input">
                                    <div id="x-select" class="select-radio-container">
                                        <h:selectBooleanCheckbox id="x-select-m2" value="#{selectXBean.selectedM2}" >
                                            <f:ajax listener="#{selectXBean.checkboxValueChanged}" render="@form" />
                                        </h:selectBooleanCheckbox> -2
                                        <h:selectBooleanCheckbox id="x-select-m15" value="#{selectXBean.selectedM15}" >
                                            <f:ajax listener="#{selectXBean.checkboxValueChanged}" render="@form" />
                                        </h:selectBooleanCheckbox> -1.5
                                        <h:selectBooleanCheckbox id="x-select-m1" value="#{selectXBean.selectedM1}" >
                                            <f:ajax listener="#{selectXBean.checkboxValueChanged}" render="@form" />
                                        </h:selectBooleanCheckbox> -1
                                        <h:selectBooleanCheckbox id="x-select-m05" value="#{selectXBean.selectedM05}" >
                                            <f:ajax listener="#{selectXBean.checkboxValueChanged}" render="@form" />
                                        </h:selectBooleanCheckbox> -0.5
                                        <h:selectBooleanCheckbox id="x-select-0" value="#{selectXBean.selected0}" >
                                            <f:ajax listener="#{selectXBean.checkboxValueChanged}" render="@form" />
                                        </h:selectBooleanCheckbox> 0
                                        <h:selectBooleanCheckbox id="x-select-05" value="#{selectXBean.selected05}" >
                                            <f:ajax listener="#{selectXBean.checkboxValueChanged}" render="@form" />
                                        </h:selectBooleanCheckbox> 0.5
                                    </div>
                                </div>
                                <span id="x-select-error" class="error" />
                            </div>
                        </div>
                        <div id="y-select-container" class="select-container margin">
                            <h:outputLabel for="y-select">Enter Y:</h:outputLabel>
                            <div class="select-input-container">
                                <div id="y-select-input" class="select-input-container">
                                    <h:inputText id="y-select" value="#{selectYBean.value}" size="25" required="true">
                                        <f:ajax execute="y-select" render="@form" />
                                    </h:inputText>
                                </div>
                                <span id="y-select-error" class="error" />
                            </div>
                        </div>
                        <div id="r-select-container" class="select-container margin">
                            <h:outputLabel for="r-select">Choose R:</h:outputLabel>
                            <div class="select-input-container">
                                <div id="r-select-input" class="select-input-container">
                                    <h:selectOneMenu id="r-select" value="#{selectRBean.value}" required="true">
                                        <f:selectItem itemLabel="---Please, choose an option---" />
                                        <f:selectItem itemValue = "1" itemLabel = "1" />
                                        <f:selectItem itemValue = "1.5" itemLabel = "1.5" />
                                        <f:selectItem itemValue = "2" itemLabel = "2" />
                                        <f:selectItem itemValue = "2.5" itemLabel = "2.5" />
                                        <f:selectItem itemValue = "3" itemLabel = "3" />
                                        <f:ajax execute="@this" render="@form" />
                                    </h:selectOneMenu>
                                </div>
                                <span id="r-select-error" class="error" />
                            </div>
                        </div>
                        <div id="submit-container" class="margin">
                            <h:commandButton id="submit-button" value="Get disappointed in your life">
                                <f:ajax execute="@this" listener="#{checkAreaResultsBean.newResult(selectXBean.value,
                                        selectYBean.value, selectRBean.value)}" render="result-table" />
                            </h:commandButton>
                        </div>
                    </h:form>

                    <!--- fixme: Rewrite it -->
                    <div id="another-way-container" class="select-container margin">
                        <label for="enable-graph">Or...</label>
                        <button id="enable-graph" onclick="enable_graph()">Enable graph aiming</button>
                    </div>
                    <h:form>
                        <input type="hidden" name="clear" value="1" />
                        <div id="clear-table-container" class="select-container margin">
                            <label for="enable-graph">You may also</label>
                            <input type="submit" id="clear-table" value="Clear table" />
                        </div>
                    </h:form>
                </div>

                <div id="graph-container" class="blured-container round-container margin">
                    <div id="graph">

                    </div>
                </div>
                <div id="result-table-container" class="blured-container margin">
                    <h:dataTable id="result-table" value="#{checkAreaResultsBean.results}" var="result">
                        <h:column>
                            <f:facet name = "header">X</f:facet>
                            #{result.x}
                        </h:column>
                        <h:column>
                            <f:facet name = "header">Y</f:facet>
                            #{result.y}
                        </h:column>
                        <h:column>
                            <f:facet name = "header">R</f:facet>
                            #{result.r}
                        </h:column>
                        <h:column>
                            <f:facet name = "header">Result</f:facet>
                            #{result.result}
                        </h:column>
                        <h:column>
                            <f:facet name = "header">Executed at</f:facet>
                            #{result.executedAt}
                        </h:column>
                        <h:column>
                            <f:facet name = "header">Execution time</f:facet>
                            #{result.execTime}
                        </h:column>
                    </h:dataTable>
                </div>
            </div>
            <div id="footer" class="blured-container round-container margin">
                <p>Copyright © Zerumi, 2023. Licensed under <a href="../LICENSE">ISC license</a>. Plagiarism is prohibited.</p>
            </div>
        </div>
        <h:outputScript library="js" name="fix-placeholder.js" />
        <script type="text/javascript" src="https://www.desmos.com/api/v1.8/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6">

        </script>
        <h:form id="graphSelect">
            <h:inputHidden id="x" value="#{selectGraphBean.x}" />
            <h:inputHidden id="y" value="#{selectGraphBean.y}" />
            <p:remoteCommand name="updateBeanValues" update="x y"
                             action="#{checkAreaResultsBean.newResult(selectGraphBean.x, selectGraphBean.y, selectRBean.value)}" />
        </h:form>
        <h:outputScript library="js" name="graph.js" />
        <h:outputScript>
            <ui:repeat var="loadedResults" value="#{checkAreaResultsBean.results}">
                drawPointXYRes('#{loadedResults.x}', '#{loadedResults.y}', '#{loadedResults.result ? 'girls sometimes may be beautiful' : ''}');
            </ui:repeat>
        </h:outputScript>
    </h:body>
</html>